<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Shree Jagadamba Selection</title>

<script src="https://cdn.tailwindcss.com"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<style>
body{font-family:Poppins,sans-serif;background:#fffaf0}
.product-card{background:#fff;border-radius:20px;overflow:hidden;cursor:pointer}
.delete-btn{display:none}
body.admin-active .delete-btn{display:flex}
</style>
</head>

<body>

<header class="text-center py-10">
<h1 class="text-4xl font-bold">Shree Jagadamba Selection</h1>
<p class="text-sm text-gray-500">Anavatti, Karnataka</p>
</header>

<!-- ADMIN PANEL -->
<section id="adminPanel" class="hidden max-w-5xl mx-auto bg-white p-6 rounded-xl shadow">
<h2 class="font-bold mb-4">Owner Panel</h2>

<div class="grid md:grid-cols-5 gap-3">
<input type="file" id="imgInp" accept="image/*" class="bg-gray-100 p-3 rounded">
<input type="text" id="itemName" placeholder="Item Name" class="bg-gray-100 p-3 rounded">
<input type="text" id="itemPrice" placeholder="Price ₹" class="bg-gray-100 p-3 rounded">

<select id="itemCat" class="bg-gray-100 p-3 rounded">
<option>Saree</option>
<option>Kurti</option>
<option>Kids Wear</option>
<option>Mens Wear</option>
<option>Other</option>
</select>

<button onclick="addItem()" class="bg-yellow-600 text-white rounded p-3 font-bold">
Upload
</button>
</div>
</section>

<!-- PRODUCTS -->
<main class="max-w-6xl mx-auto p-6 grid grid-cols-2 md:grid-cols-4 gap-4" id="productGrid"></main>

<footer class="text-center py-10">
<button onclick="openLogin()" class="text-sm text-gray-500">
<i class="fa fa-lock"></i> Owner Login
</button>
</footer>

<!-- LOGIN -->
<div id="loginModal" class="hidden fixed inset-0 bg-black/80 flex items-center justify-center">
<div class="bg-white p-6 rounded-xl">
<input type="password" id="passInput" placeholder="Password" class="p-3 border rounded w-full mb-3">
<button onclick="verifyAdmin()" class="bg-yellow-600 text-white w-full p-3 rounded">Login</button>
</div>
</div>

<script>
function openLogin(){
loginModal.classList.remove("hidden")
}
function verifyAdmin(){
if(passInput.value==="sirvitarun9828"){
adminPanel.classList.remove("hidden")
document.body.classList.add("admin-active")
loginModal.classList.add("hidden")
}else alert("Wrong Password")
}
</script>

<!-- FIREBASE -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
import { getFirestore, collection, addDoc, onSnapshot, deleteDoc, doc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
import { getStorage, ref, uploadBytes, getDownloadURL } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-storage.js";
import { getAuth, signInAnonymously } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";

const firebaseConfig = JSON.parse(__firebase_config);
const app = initializeApp(firebaseConfig);

const db = getFirestore(app);
const storage = getStorage(app);
const auth = getAuth(app);
signInAnonymously(auth);

const appId = "jagadamba-shop";

window.addItem = async () => {
const file = imgInp.files[0];
const name = itemName.value;
const price = itemPrice.value;
const cat = itemCat.value;

if(!file||!name||!price){alert("Fill all");return;}

const imgRef = ref(storage, `products/${Date.now()}_${file.name}`);
await uploadBytes(imgRef, file);
const imageUrl = await getDownloadURL(imgRef);

await addDoc(collection(db,"artifacts",appId,"public","data","products"),{
name,price,category:cat,imageUrl
});

itemName.value="";itemPrice.value="";imgInp.value="";
};

const grid = document.getElementById("productGrid");

onSnapshot(collection(db,"artifacts",appId,"public","data","products"), snap=>{
grid.innerHTML="";
snap.forEach(d=>{
const p=d.data();
const div=document.createElement("div");
div.className="product-card relative";

div.innerHTML=`
<button class="delete-btn absolute top-2 right-2 bg-red-500 text-white w-8 h-8 rounded-full"
onclick="deleteItem('${d.id}')">
<i class="fa fa-trash"></i>
</button>
<img src="${p.imageUrl}" class="w-full h-48 object-cover">
<div class="p-3 text-center">
<b>${p.name}</b>
<p class="text-yellow-600 font-bold">₹${p.price}</p>
</div>`;
grid.appendChild(div);
});
});

window.deleteItem = async (id)=>{
if(confirm("Delete?")){
await deleteDoc(doc(db,"artifacts",appId,"public","data","products",id))
}
}
</script>

</body>
    </html>
